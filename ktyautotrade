local HttpService = game:GetService("HttpService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local DataRequestEvent = ReplicatedStorage:WaitForChild("DataRequestEvent")

local function postDataToSheet(data)
    local jsonData = HttpService:JSONEncode(data)
    local response = HttpService:RequestAsync({
        Url = "https://sheet.best/api/sheets/YOUR_SHEET_ID",
        Method = "POST",
        Headers = {["Content-Type"] = "application/json"},
        Body = jsonData
    })
    
    print(response.StatusCode, response.Body)
end

DataRequestEvent.OnServerEvent:Connect(function(player, data)
    postDataToSheet(data)
end)


-- Example data
local data = {
    {Id = "10", Name = "Jack Doe", Age = "97"},
    {Id = "11", Name = "John Doe", Age = "44"}
}

-- Function to trigger the event
local function sendData()
    DataRequestEvent:FireServer(data)
end

-- Example call to the function
sendData()
